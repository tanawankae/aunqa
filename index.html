<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="แดชบอร์ดผลการประเมิน AUN-QA วิทยาลัยพยาบาลบรมราชชนนี ชัยนาท ปีการศึกษา 2565-2567">
    <title>ผลการประเมิน AUN-QA 2565-2567</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Sarabun:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeInDown 1s ease-out;
        }

        .header h1 {
            font-family: 'Kanit', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header h2 {
            font-family: 'Kanit', sans-serif;
            font-size: 1.2rem;
            font-weight: 300;
            opacity: 0.9;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin-bottom: 40px;
        }

        .dashboard-grid-row2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: fadeInUp 0.8s ease-out;
            margin-bottom: 25px;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            background: linear-gradient(45deg, #4A90E2, #357ABD);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 24px;
            color: white;
        }

        .card-title {
            font-family: 'Kanit', sans-serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: #2C3E50;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px 15px;
            background: linear-gradient(45deg, #f8f9ff, #e3f2fd);
            border-radius: 12px;
            border-left: 4px solid #4A90E2;
        }

        .stat-value {
            font-family: 'Kanit', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: #2C3E50;
            margin-bottom: 5px;
        }

        .stat-label {
            font-family: 'Sarabun', sans-serif;
            font-size: 0.9rem;
            color: #7F8C8D;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 25px 0;
            padding: 15px;
            background: rgba(248, 249, 250, 0.5);
            border-radius: 10px;
        }

        .criteria-list {
            list-style: none;
        }

        .criteria-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #ecf0f1;
            margin-bottom: 5px;
        }

        .criteria-item:last-child {
            border-bottom: none;
        }

        .criteria-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4A90E2, #357ABD);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 20px;
            font-size: 1rem;
            box-shadow: 0 3px 10px rgba(74, 144, 226, 0.3);
        }

        .criteria-info {
            flex: 1;
        }

        .criteria-name {
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            color: #2C3E50;
            margin-bottom: 8px;
            line-height: 1.3;
        }

        .criteria-scores {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-top: 5px;
        }

        .score-badge {
            font-family: 'Kanit', sans-serif;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .score-excellent {
            background: #27ae60;
            color: white;
        }

        .score-good {
            background: #f39c12;
            color: white;
        }

        .score-improvement {
            background: #e74c3c;
            color: white;
        }

        .trend-arrow {
            font-size: 1.2rem;
            margin-left: 10px;
        }

        .trend-up {
            color: #27ae60;
        }

        .trend-stable {
            color: #f39c12;
        }

        .heatmap-grid {
            display: grid;
            grid-template-columns: auto repeat(3, 1fr);
            gap: 8px;
            margin: 25px 0;
            padding: 20px;
            background: rgba(248, 249, 250, 0.3);
            border-radius: 12px;
        }

        .heatmap-header {
            font-family: 'Kanit', sans-serif;
            background: #34495e;
            color: white;
            padding: 15px 10px;
            text-align: center;
            font-weight: 600;
            font-size: 0.95rem;
            border-radius: 8px;
        }

        .heatmap-cell {
            font-family: 'Kanit', sans-serif;
            padding: 18px;
            text-align: center;
            border-radius: 10px;
            font-weight: 600;
            color: white;
            transition: transform 0.2s ease;
            font-size: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .heatmap-cell:hover {
            transform: scale(1.05);
        }

        .heatmap-label {
            font-family: 'Sarabun', sans-serif;
            background: #2c3e50;
            color: white;
            padding: 18px 15px;
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            border-radius: 8px;
            line-height: 1.2;
        }

        .score-4 { background: #27ae60; }
        .score-3 { background: #f39c12; }
        .score-2 { background: #e74c3c; }

        .insights-section {
            margin-top: 40px;
        }

        .insight-card {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .insight-title {
            font-family: 'Kanit', sans-serif;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255,255,255,0.3);
        }

        .insight-content {
            font-family: 'Sarabun', sans-serif;
            font-size: 1.05rem;
            line-height: 1.7;
            padding-top: 5px;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .improvement-badge {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            padding: 6px 12px;
            border-radius: 18px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 8px;
            box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .dashboard-grid-row2 {
                grid-template-columns: 1fr;
            }
            
            .heatmap-grid {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📊 ผลการประเมิน AUN-QA</h1>
            <h2>วิทยาลัยพยาบาลบรมราชชนนี ชัยนาท | ปีการศึกษา 2565-2567</h2>
        </div>

        <div class="dashboard-grid">
            <!-- ภาพรวมผลการประเมิน -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">🎯</div>
                    <div class="card-title">ภาพรวมผลการประเมิน</div>
                </div>
                <div class="summary-stats">
                    <div class="stat-item">
                        <div class="stat-value">8</div>
                        <div class="stat-label">เกณฑ์หลัก</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">3.00</div>
                        <div class="stat-label">คะแนน 2565</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">3.63</div>
                        <div class="stat-label">คะแนน 2566</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">3.63</div>
                        <div class="stat-label">คะแนน 2567</div>
                    </div>
                </div>
                <div class="insight-card" style="margin-top: 25px;">
                    <div class="insight-title">📈 การพัฒนาโดยรวม</div>
                    <div class="insight-content">
                        <strong>+0.63 คะแนน</strong> (เพิ่มขึ้น 20.8%)<br>
                        มีการพัฒนาอย่างมีนัยสำคัญในปี 2566 และคงระดับในปี 2567
                    </div>
                </div>
            </div>

            <!-- กราฟแนวโน้ม -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">📈</div>
                    <div class="card-title">แนวโน้มคะแนนเฉลี่ย</div>
                </div>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>

            <!-- จุดแข็ง -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">🏆</div>
                    <div class="card-title">จุดแข็ง (คะแนน 4)</div>
                </div>
                <ul class="criteria-list">
                    <li class="criteria-item">
                        <div class="criteria-number">1</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Expected Learning Outcomes</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-excellent">4.0</span>
                                <span class="improvement-badge">+1.0</span>
                            </div>
                        </div>
                    </li>
                    <li class="criteria-item">
                        <div class="criteria-number">2</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Programme Structure and Content</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-excellent">4.0</span>
                                <span class="improvement-badge">+1.0</span>
                            </div>
                        </div>
                    </li>
                    <li class="criteria-item">
                        <div class="criteria-number">4</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Student Assessment</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-excellent">4.0</span>
                                <span class="improvement-badge">+1.0</span>
                            </div>
                        </div>
                    </li>
                    <li class="criteria-item">
                        <div class="criteria-number">5</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Academic Staff</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-excellent">4.0</span>
                                <span class="improvement-badge">+1.0</span>
                            </div>
                        </div>
                    </li>
                    <li class="criteria-item">
                        <div class="criteria-number">7</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Facilities and Infrastructure</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-excellent">4.0</span>
                                <span style="color: #7F8C8D; font-size: 0.8rem;">คงที่</span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>

        <div class="dashboard-grid-row2">
            <!-- จุดที่ต้องพัฒนา -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">⚡</div>
                    <div class="card-title">จุดที่ต้องพัฒนา</div>
                </div>
                <ul class="criteria-list">
                    <li class="criteria-item">
                        <div class="criteria-number">3</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Teaching and Learning Approach</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-good">3.0</span>
                                <span style="color: #e74c3c; font-size: 0.8rem;">ไม่เปลี่ยนแปลง</span>
                            </div>
                        </div>
                    </li>
                    <li class="criteria-item">
                        <div class="criteria-number">6</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Student Support Services</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-good">3.0</span>
                                <span style="color: #e74c3c; font-size: 0.8rem;">ไม่เปลี่ยนแปลง</span>
                            </div>
                        </div>
                    </li>
                    <li class="criteria-item">
                        <div class="criteria-number">8</div>
                        <div class="criteria-info">
                            <div class="criteria-name">Output and Outcomes</div>
                            <div class="criteria-scores">
                                <span class="score-badge score-good">3.0</span>
                                <span class="improvement-badge">+1.0</span>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- กราฟเปรียบเทียบ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">📊</div>
                    <div class="card-title">เปรียบเทียบคะแนนแต่ละเกณฑ์</div>
                </div>
                <div class="chart-container">
                    <canvas id="comparisonChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Heatmap -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">🔥</div>
                <div class="card-title">Heat Map คะแนนตามเกณฑ์</div>
            </div>
            <div class="heatmap-grid">
                <div class="heatmap-header">เกณฑ์</div>
                <div class="heatmap-header">2565</div>
                <div class="heatmap-header">2566</div>
                <div class="heatmap-header">2567</div>
                
                <div class="heatmap-label">Criterion 1<br>Expected Learning Outcomes</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-4">4</div>
                <div class="heatmap-cell score-4">4</div>
                
                <div class="heatmap-label">Criterion 2<br>Programme Structure</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-4">4</div>
                <div class="heatmap-cell score-4">4</div>
                
                <div class="heatmap-label">Criterion 3<br>Teaching & Learning</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-3">3</div>
                
                <div class="heatmap-label">Criterion 4<br>Student Assessment</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-4">4</div>
                <div class="heatmap-cell score-4">4</div>
                
                <div class="heatmap-label">Criterion 5<br>Academic Staff</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-4">4</div>
                <div class="heatmap-cell score-4">4</div>
                
                <div class="heatmap-label">Criterion 6<br>Student Support</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-3">3</div>
                
                <div class="heatmap-label">Criterion 7<br>Facilities</div>
                <div class="heatmap-cell score-4">4</div>
                <div class="heatmap-cell score-4">4</div>
                <div class="heatmap-cell score-4">4</div>
                
                <div class="heatmap-label">Criterion 8<br>Output & Outcomes</div>
                <div class="heatmap-cell score-2">2</div>
                <div class="heatmap-cell score-3">3</div>
                <div class="heatmap-cell score-3">3</div>
            </div>
        </div>

        <!-- ข้อเสนอแนะเชิงกลยุทธ์ -->
        <div class="insights-section">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">💡</div>
                    <div class="card-title">ข้อเสนอแนะเชิงกลยุทธ์</div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">🚀 จุดที่ควรเร่งพัฒนา</div>
                    <div class="insight-content">
                        <strong>• การจัดการเรียนการสอน (Criterion 3)</strong> - ยังคงที่ 3 คะแนนตลอด 3 ปี ควรปรับปรุงวิธีการสอนให้หลากหลายและทันสมัย<br>
                        <strong>• บริการสนับสนุนนักศึกษา (Criterion 6)</strong> - ต้องเพิ่มประสิทธิภาพและครอบคลุมมากขึ้น
                    </div>
                </div>

                <div class="insight-card">
                    <div class="insight-title">🛡️ จุดที่ควรรักษาไว้</div>
                    <div class="insight-content">
                        <strong>• โครงสร้างหลักสูตรและการประเมินผล</strong> - อยู่ในระดับดีแล้ว (คะแนน 4)<br>
                        <strong>• บุคลากรและสิ่งอำนวยความสะดวก</strong> - เป็นจุดแข็งที่ต้องรักษาต่อไป
                    </div>
                </div>

                <div class="insight-card">
                    <div class="insight-title">📋 แนวทางพัฒนาที่แนะนำ</div>
                    <div class="insight-content">
                        <strong>1. พัฒนาการเรียนการสอน:</strong> นำเทคโนโลยีมาใช้ในการสอน, พัฒนา Active Learning<br>
                        <strong>2. เสริมสร้างการสนับสนุนนักศึกษา:</strong> ระบบให้คำปรึกษา, บริการช่วยเหลือการเรียน<br>
                        <strong>3. ติดตามผลลัพธ์:</strong> พัฒนาระบบติดตามผลการศึกษาและการมีงานทำของบัณฑิต
                    </div>
                </div>
            </div>
        </div>

        <!-- การวิเคราะห์เชิงลึกจากข้อมูลจริง -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">🔍</div>
                <div class="card-title">การวิเคราะห์เชิงลึกจากข้อมูล</div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-top: 25px;">
                <!-- Gap Analysis -->
                <div style="background: #f8f9fa; padding: 25px; border-radius: 12px; border-left: 4px solid #e74c3c; box-shadow: 0 3px 15px rgba(0,0,0,0.1);">
                    <h4 style="font-family: 'Kanit', sans-serif; color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1;">📊 Gap to Excellence (เป้าหมาย 4 คะแนน)</h4>
                    <div style="font-family: 'Sarabun', sans-serif;">
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>Criterion 3:</strong> ต้องปรับปรุง 1.0 คะแนน</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>Criterion 6:</strong> ต้องปรับปรุง 1.0 คะแนน</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>Criterion 8:</strong> ต้องปรับปรุง 1.0 คะแนน</div>
                        <div style="color: #27ae60; font-weight: 600; margin-top: 15px; padding: 10px; background: rgba(39, 174, 96, 0.1); border-radius: 8px;">Gap รวม: 3.0 คะแนน (37.5% ของเป้าหมาย)</div>
                    </div>
                </div>

                <!-- Performance Velocity -->
                <div style="background: #f8f9fa; padding: 25px; border-radius: 12px; border-left: 4px solid #f39c12; box-shadow: 0 3px 15px rgba(0,0,0,0.1);">
                    <h4 style="font-family: 'Kanit', sans-serif; color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1;">⚡ ความเร็วการพัฒนา</h4>
                    <div style="font-family: 'Sarabun', sans-serif;">
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>ปี 2565→2566:</strong> +0.63 คะแนน/ปี</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>ปี 2566→2567:</strong> 0.00 คะแนน/ปี</div>
                        <div style="color: #e74c3c; font-weight: 600; margin-top: 15px; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 8px;">⚠️ การพัฒนาชะลอตัวอย่างสิ้นเชิง</div>
                        <div style="margin-top: 12px; font-size: 0.95rem; padding: 8px 0;">ต้องเร่งกลยุทธ์ใหม่ให้มีความต่อเนื่อง</div>
                    </div>
                </div>

                <!-- Stability Analysis -->
                <div style="background: #f8f9fa; padding: 25px; border-radius: 12px; border-left: 4px solid #27ae60; box-shadow: 0 3px 15px rgba(0,0,0,0.1);">
                    <h4 style="font-family: 'Kanit', sans-serif; color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #ecf0f1;">🛡️ ความมั่นคงของคะแนน</h4>
                    <div style="font-family: 'Sarabun', sans-serif;">
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>เกณฑ์คงที่ตลอด 3 ปี:</strong> 3 เกณฑ์</div>
                        <div style="margin-bottom: 8px; padding: 5px 0;">• Criterion 3: 3-3-3 🔴</div>
                        <div style="margin-bottom: 8px; padding: 5px 0;">• Criterion 6: 3-3-3 🔴</div>
                        <div style="margin-bottom: 12px; padding: 5px 0;">• Criterion 7: 4-4-4 🟢</div>
                        <div style="color: #e74c3c; font-weight: 600; margin-top: 15px; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 8px;">37.5% ของเกณฑ์ไม่มีการพัฒนา</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Matrix -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">📋</div>
                <div class="card-title">Matrix การจัดลำดับความสำคัญ</div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin-top: 25px;">
                <!-- High Priority -->
                <div style="background: linear-gradient(45deg, #e74c3c, #c0392b); color: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 20px rgba(231, 76, 60, 0.3);">
                    <h4 style="font-family: 'Kanit', sans-serif; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 2px solid rgba(255,255,255,0.3);">🚨 สำคัญมาก (ไม่มีการพัฒนา)</h4>
                    <div style="font-family: 'Sarabun', sans-serif;">
                        <div style="margin-bottom: 15px; padding: 10px 0;"><strong>Criterion 3:</strong> Teaching & Learning</div>
                        <div style="margin-bottom: 15px; padding: 10px 0;"><strong>Criterion 6:</strong> Student Support</div>
                        <div style="opacity: 0.9; font-size: 0.95rem; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 8px;">ต้องดำเนินการทันที เพราะไม่มีการปรับปรุงตลอด 3 ปี</div>
                    </div>
                </div>

                <!-- Medium Priority -->
                <div style="background: linear-gradient(45deg, #f39c12, #d68910); color: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 20px rgba(243, 156, 18, 0.3);">
                    <h4 style="font-family: 'Kanit', sans-serif; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 2px solid rgba(255,255,255,0.3);">⚠️ สำคัญปานกลาง (พัฒนาแล้วหยุด)</h4>
                    <div style="font-family: 'Sarabun', sans-serif;">
                        <div style="margin-bottom: 15px; padding: 10px 0;"><strong>Criterion 8:</strong> Output & Outcomes</div>
                        <div style="opacity: 0.9; font-size: 0.95rem; padding: 12px; background: rgba(0,0,0,0.2); border-radius: 8px;">พัฒนาได้ +1 คะแนน แต่ยังไม่ถึงเป้าหมาย ต้องดำเนินการต่อเนื่อง</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistical Insights -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">📈</div>
                <div class="card-title">ข้อมูลเชิงสถิติจากการวิเคราะห์</div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 25px;">
                <div class="stat-item">
                    <div class="stat-value" style="color: #27ae60;">62.5%</div>
                    <div class="stat-label">เกณฑ์ที่พัฒนาสำเร็จ (5/8)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" style="color: #e74c3c;">25%</div>
                    <div class="stat-label">เกณฑ์ที่ไม่มีการพัฒนา (2/8)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" style="color: #f39c12;">12.5%</div>
                    <div class="stat-label">เกณฑ์ที่พัฒนาแล้วหยุด (1/8)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" style="color: #3498db;">0.21</div>
                    <div class="stat-label">อัตราการพัฒนาเฉลี่ย/ปี</div>
                </div>
            </div>

            <div style="margin-top: 25px; background: #ecf0f1; padding: 20px; border-radius: 12px; box-shadow: 0 3px 15px rgba(0,0,0,0.1);">
                <h4 style="font-family: 'Kanit', sans-serif; color: #2c3e50; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #bdc3c7;">🎯 การคาดการณ์จากข้อมูลปัจจุบัน</h4>
                <div style="font-family: 'Sarabun', sans-serif; color: #34495e; line-height: 1.7;">
                    <strong>หากดำเนินการต่อด้วยอัตราเดิม (0.21 คะแนน/ปี):</strong><br><br>
                    • Criterion 3 & 6 จะถึง 4 คะแนนในปี 2571-2572 (อีก 4-5 ปี)<br>
                    • แต่ในปี 2567 ไม่มีการพัฒนาเลย จึงต้องเร่งกลยุทธ์ใหม่<br><br>
                    <span style="color: #e74c3c; font-weight: 600; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 8px; display: inline-block; margin-top: 10px;">⚠️ จำเป็นต้องเปลี่ยนแนวทางเพื่อให้บรรลุเป้าหมายเร็วขึ้น</span>
                </div>
            </div>
        </div>

        <!-- Pattern Analysis -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">🔄</div>
                <div class="card-title">รูปแบบการพัฒนาที่พบจากข้อมูล</div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-top: 25px;">
                <!-- Success Pattern -->
                <div style="background: #d5f4e6; padding: 25px; border-radius: 12px; border-left: 4px solid #27ae60; box-shadow: 0 3px 15px rgba(39, 174, 96, 0.2);">
                    <h4 style="font-family: 'Kanit', sans-serif; color: #27ae60; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid rgba(39, 174, 96, 0.3);">✅ รูปแบบความสำเร็จ</h4>
                    <div style="font-family: 'Sarabun', sans-serif; color: #2c3e50;">
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>พฤติกรรม:</strong> 3→4→4</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>จำนวน:</strong> 4 เกณฑ์ (C1, C2, C4, C5)</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>ลักษณะ:</strong> พัฒนาเป็นขั้น แล้วรักษาระดับ</div>
                        <div style="font-weight: 600; margin-top: 15px; padding: 10px; background: rgba(39, 174, 96, 0.1); border-radius: 8px;">สามารถนำแนวทางไปใช้กับเกณฑ์อื่น</div>
                    </div>
                </div>

                <!-- Stagnation Pattern -->
                <div style="background: #fdeaea; padding: 25px; border-radius: 12px; border-left: 4px solid #e74c3c; box-shadow: 0 3px 15px rgba(231, 76, 60, 0.2);">
                    <h4 style="font-family: 'Kanit', sans-serif; color: #e74c3c; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid rgba(231, 76, 60, 0.3);">🔴 รูปแบบความนิ่ง</h4>
                    <div style="font-family: 'Sarabun', sans-serif; color: #2c3e50;">
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>พฤติกรรม:</strong> 3→3→3</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>จำนวน:</strong> 2 เกณฑ์ (C3, C6)</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>ลักษณะ:</strong> ไม่มีการเปลี่ยนแปลงใดๆ</div>
                        <div style="font-weight: 600; color: #e74c3c; margin-top: 15px; padding: 10px; background: rgba(231, 76, 60, 0.1); border-radius: 8px;">ต้องหาสาเหตุและแก้ไขเร่งด่วน</div>
                    </div>
                </div>

                <!-- Unique Pattern -->
                <div style="background: #fff3cd; padding: 25px; border-radius: 12px; border-left: 4px solid #f39c12; box-shadow: 0 3px 15px rgba(243, 156, 18, 0.2);">
                    <h4 style="font-family: 'Kanit', sans-serif; color: #f39c12; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid rgba(243, 156, 18, 0.3);">⭐ รูปแบบพิเศษ</h4>
                    <div style="font-family: 'Sarabun', sans-serif; color: #2c3e50;">
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>Criterion 7:</strong> 4→4→4 (เริ่มต้นดีแล้ว)</div>
                        <div style="margin-bottom: 12px; padding: 8px 0;"><strong>Criterion 8:</strong> 2→3→3 (ปรับปรุงแล้วหยุด)</div>
                        <div style="font-weight: 600; margin-top: 15px; padding: 10px; background: rgba(243, 156, 18, 0.1); border-radius: 8px;">C7 = แบบอย่าง, C8 = ต้องดันต่อ</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="card-header">
                <div class="card-icon">📈</div>
                <div class="card-title">การเปลี่ยนแปลงคะแนนแต่ละเกณฑ์ (2565 → 2567)</div>
            </div>
            <div class="chart-container">
                <canvas id="changeChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // ข้อมูลคะแนน
        const criteriaData = [
            { name: 'Expected Learning Outcomes', scores: [3, 4, 4], change: 1 },
            { name: 'Programme Structure', scores: [3, 4, 4], change: 1 },
            { name: 'Teaching & Learning', scores: [3, 3, 3], change: 0 },
            { name: 'Student Assessment', scores: [3, 4, 4], change: 1 },
            { name: 'Academic Staff', scores: [3, 4, 4], change: 1 },
            { name: 'Student Support', scores: [3, 3, 3], change: 0 },
            { name: 'Facilities', scores: [4, 4, 4], change: 0 },
            { name: 'Output & Outcomes', scores: [2, 3, 3], change: 1 }
        ];

        // สีธีมน้ำเงิน
        const blueTheme = {
            primary: '#4A90E2',
            secondary: '#357ABD',
            accent: '#5BA0F2',
            light: '#E3F2FD',
            dark: '#2C3E50',
            success: '#27ae60',
            warning: '#f39c12',
            danger: '#e74c3c'
        };

        // กราฟแนวโน้มคะแนนเฉลี่ย
        const trendCtx = document.getElementById('trendChart').getContext('2d');
        new Chart(trendCtx, {
            type: 'line',
            data: {
                labels: ['2565', '2566', '2567'],
                datasets: [{
                    label: 'คะแนนเฉลี่ย',
                    data: [3.00, 3.63, 3.63],
                    borderColor: blueTheme.primary,
                    backgroundColor: blueTheme.light,
                    borderWidth: 4,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: blueTheme.primary,
                    pointBorderColor: '#fff',
                    pointBorderWidth: 3,
                    pointRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: blueTheme.dark,
                        titleFont: { family: 'Kanit', size: 14, weight: 'bold' },
                        bodyFont: { family: 'Sarabun', size: 12 },
                        padding: 10,
                        cornerRadius: 8
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 4,
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        },
                        ticks: {
                            stepSize: 1,
                            font: {
                                family: 'Kanit',
                                size: 12,
                                weight: 'bold'
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                family: 'Kanit',
                                size: 12,
                                weight: 'bold'
                            }
                        }
                    }
                },
                animation: {
                    duration: 2000,
                    easing: 'easeOutQuart'
                }
            }
        });

        // กราฟเปรียบเทียบคะแนน
        const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
        new Chart(comparisonCtx, {
            type: 'bar',
            data: {
                labels: criteriaData.map((_, i) => `C${i+1}`),
                datasets: [
                    {
                        label: '2565',
                        data: criteriaData.map(c => c.scores[0]),
                        backgroundColor: 'rgba(52, 152, 219, 0.8)',
                        borderColor: '#3498db',
                        borderWidth: 2
                    },
                    {
                        label: '2566',
                        data: criteriaData.map(c => c.scores[1]),
                        backgroundColor: 'rgba(155, 89, 182, 0.8)',
                        borderColor: '#9b59b6',
                        borderWidth: 2
                    },
                    {
                        label: '2567',
                        data: criteriaData.map(c => c.scores[2]),
                        backgroundColor: 'rgba(231, 76, 60, 0.8)',
                        borderColor: '#e74c3c',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            usePointStyle: true,
                            font: {
                                family: 'Kanit',
                                size: 12,
                                weight: 'bold'
                            }
                        }
                    },
                    tooltip: {
                        backgroundColor: blueTheme.dark,
                        titleFont: { family: 'Kanit', size: 14, weight: 'bold' },
                        bodyFont: { family: 'Sarabun', size: 12 },
                        padding: 10,
                        cornerRadius: 8
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 4,
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        },
                        ticks: {
                            stepSize: 1,
                            font: {
                                family: 'Kanit',
                                size: 11,
                                weight: 'bold'
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                family: 'Kanit',
                                size: 11,
                                weight: 'bold'
                            }
                        }
                    }
                },
                animation: {
                    duration: 1500,
                    easing: 'easeOutCubic'
                }
            }
        });

        // กราฟการเปลี่ยนแปลง
        const changeCtx = document.getElementById('changeChart').getContext('2d');
        new Chart(changeCtx, {
            type: 'bar',
            data: {
                labels: criteriaData.map((_, i) => `Criterion ${i+1}`),
                datasets: [{
                    label: 'การเปลี่ยนแปลง (คะแนน)',
                    data: criteriaData.map(c => c.change),
                    backgroundColor: criteriaData.map(c => {
                        if (c.change > 0) return blueTheme.success;
                        if (c.change < 0) return blueTheme.danger;
                        return blueTheme.warning;
                    }),
                    borderColor: criteriaData.map(c => {
                        if (c.change > 0) return '#219a52';
                        if (c.change < 0) return '#c0392b';
                        return '#d68910';
                    }),
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: blueTheme.dark,
                        titleFont: { family: 'Kanit', size: 14, weight: 'bold' },
                        bodyFont: { family: 'Sarabun', size: 12 },
                        padding: 10,
                        cornerRadius: 8
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(0,0,0,0.1)'
                        },
                        ticks: {
                            stepSize: 0.5,
                            font: {
                                family: 'Kanit',
                                size: 12,
                                weight: 'bold'
                            }
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        },
                        ticks: {
                            font: {
                                family: 'Kanit',
                                size: 10,
                                weight: 'bold'
                            },
                            maxRotation: 45
                        }
                    }
                },
                animation: {
                    duration: 1800,
                    easing: 'easeOutBack'
                }
            }
        });

        // เอฟเฟคเคลื่อนไหวเมื่อโหลดหน้า
        window.addEventListener('load', function() {
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });
        });
    </script>
</body>
</html>
